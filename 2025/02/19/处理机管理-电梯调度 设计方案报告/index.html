<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>处理机管理-电梯调度 设计方案报告 | kiy-00的生活学习碎片</title><meta name="author" content="kiy-00"><meta name="copyright" content="kiy-00"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#B1C379"><meta name="description" content="同济大学操作系统课程项目">
<meta property="og:type" content="article">
<meta property="og:title" content="处理机管理-电梯调度 设计方案报告">
<meta property="og:url" content="http://example.com/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/index.html">
<meta property="og:site_name" content="kiy-00的生活学习碎片">
<meta property="og:description" content="同济大学操作系统课程项目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png">
<meta property="article:published_time" content="2025-02-19T08:00:00.000Z">
<meta property="article:modified_time" content="2025-02-19T08:15:20.710Z">
<meta property="article:author" content="kiy-00">
<meta property="article:tag" content="面向作者">
<meta property="article:tag" content="操作系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "处理机管理-电梯调度 设计方案报告",
  "url": "http://example.com/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/",
  "image": "http://example.com/img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png",
  "datePublished": "2025-02-19T08:00:00.000Z",
  "dateModified": "2025-02-19T08:15:20.710Z",
  "author": [
    {
      "@type": "Person",
      "name": "kiy-00",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#87A063')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#B1C379')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '处理机管理-电梯调度 设计方案报告',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/bg.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友人账</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/elevator-images/运行时截图.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/butterfly-icon.jpg" alt="Logo"><span class="site-name">kiy-00的生活学习碎片</span></a><a class="nav-page-title" href="/"><span class="site-name">处理机管理-电梯调度 设计方案报告</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友人账</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">处理机管理-电梯调度 设计方案报告</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-02-19T08:00:00.000Z" title="发表于 2025-02-19 16:00:00">2025-02-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-02-19T08:15:20.710Z" title="更新于 2025-02-19 16:15:20">2025-02-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="处理机管理-电梯调度-设计方案报告"><a href="#处理机管理-电梯调度-设计方案报告" class="headerlink" title="处理机管理-电梯调度 设计方案报告"></a>处理机管理-电梯调度 设计方案报告</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><a href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83">开发环境</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD">实现的功能</a></li>
<li><a href="#%E7%95%8C%E9%9D%A2">界面</a></li>
<li><a href="#%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97">操作指南</a></li>
<li><a href="#%E4%B8%BB%E8%A6%81%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF">主要设计思路</a><ul>
<li><a href="#%E5%AE%9E%E7%8E%B0%E7%9A%84%E7%B1%BB">实现的类</a><ul>
<li><a href="#Elevator%E7%B1%BB">Elevator类</a></li>
<li><a href="#Passenger%E7%B1%BB">Passenger类</a></li>
</ul>
</li>
<li><a href="#%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB">类之间的联系</a></li>
<li><a href="#%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95">调度算法</a></li>
<li><a href="#%E7%94%B5%E6%A2%AF%E8%BF%90%E8%A1%8C%E9%80%BB%E8%BE%91">电梯运行逻辑</a></li>
<li><a href="#%E4%BA%8B%E4%BB%B6%E5%AE%9A%E4%B9%89">事件定义</a></li>
<li><a href="#%E5%AE%9A%E4%B9%89%E5%AE%9A%E6%97%B6%E5%99%A8">定义定时器</a></li>
</ul>
</li>
</ul>
<h3 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h3><ul>
<li>开发环境：Windows 11</li>
<li>开发软件：Visual Studio 2022</li>
<li>开发语言：C#</li>
<li>主要引用模块：<ul>
<li>System</li>
<li>System.Threading</li>
</ul>
</li>
</ul>
<h3 id="实现的功能"><a href="#实现的功能" class="headerlink" title="实现的功能"></a>实现的功能</h3><ul>
<li>互联接的上下行按钮：当按下五部电梯门口的上下行按钮时，五部电梯都收到这个请求，根据调度算法决定具体由哪部电梯响应这个请求；</li>
<li>独立的楼层按钮：每部电梯都有各自的楼层按钮，当按下电梯内部的楼层按钮时，该请求由这部电梯响应，具体何时响应由调度算法决定；</li>
<li>添加乘客功能：支持添加乘客，需指定乘客起始楼层和目标楼层，调度算法决定由哪部电梯响应乘客的请求；</li>
<li>数码管显示电梯当前楼层：每部电梯都有一个数码管显示其当前所在楼层；</li>
<li>电梯状态显示：每部电梯都有一个标签显示电梯当前状态：有up，down，wait，alarm四种状态；</li>
<li>电梯容量显示：每部电梯都有一个标签显示电梯可用容量，初始为5；</li>
<li>开门、关门键：当电梯到达乘客所在楼层和目标楼层时，需要完成开门和关门操作；</li>
<li>提示信息框：在特定时候弹出提示信息，显示乘客被分配到了哪部电梯以及提示用户进行开门或关门操作；</li>
<li>乘客状态表：根据乘客状态实时更新乘客当前所在楼层，只显示未到达目标楼层的乘客；</li>
</ul>
<h3 id="界面"><a href="#界面" class="headerlink" title="界面"></a>界面</h3><p><img src="/../img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" alt="运行时截图"></p>
<h3 id="操作指南"><a href="#操作指南" class="headerlink" title="操作指南"></a>操作指南</h3><ul>
<li>用户可以随意点击数字键和上行下行键让电梯在没有乘客的情况下”空跑“，便于观察电梯调度算法的实际表现；</li>
<li>用户也可以在右侧的乘客管理模块添加乘客，设定乘客的起始楼层和目标楼层，观察乘客被分配到哪个电梯中，以及乘客乘上电梯时的实际楼层变化，当乘客到达目标楼层时，乘客将从表格中移除；</li>
<li>下方的状态栏显示提示信息，提示用户在必要时刻进行开门和关门操作；</li>
<li>乘客可以点击”Open“和”Close“键让电梯开门和关门，也可以按下”Alarm“键让电梯处于报警状态；</li>
<li>电梯所在楼层和剩余容量在每部电梯上方显示，电梯的当前状态在每部电梯下方显示。</li>
</ul>
<h3 id="主要设计思路"><a href="#主要设计思路" class="headerlink" title="主要设计思路"></a>主要设计思路</h3><h4 id="实现的类"><a href="#实现的类" class="headerlink" title="实现的类"></a>实现的类</h4><ul>
<li><code>Form1</code>类：程序的主窗口，负责UI的显示与更新，处理UI的点击事件，管理与乘客有关的逻辑、订阅<code>ElevatorController</code>中定义的事件；</li>
<li><code>ElevatorController</code>类：实现了电梯的调度算法，管理电梯列表，定义了一些关键的事件；</li>
<li><code>Elevator</code>类：记录电梯的属性，包括电梯的当前楼层，目标楼层，电梯的状态，电梯的容量，提供了一些公用的方法，可以对电梯的这些属性进行设置和获取；</li>
<li><code>Passenger</code>类：记录每个乘客的ID，当前所在楼层和目标楼层，被分配到的电梯，以及请求是否已被处理；</li>
</ul>
<h5 id="Elevator类"><a href="#Elevator类" class="headerlink" title="Elevator类"></a>Elevator类</h5><ul>
<li><p>电梯的实体，记录每部电梯的状态（等待，上行，下行，报警），当前所在楼层和目标楼层，定义了一些必要的方法，用于得到或设置电梯内的一些成员变量：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">ElevatorSystem</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">enum</span> status</span><br><span class="line">    &#123;</span><br><span class="line">        wait, up, down, alarm</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Elevator</span></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		status currentStatus;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">int</span> currentFloor;</span><br><span class="line">		<span class="built_in">int</span> targetFloor;</span><br><span class="line">		<span class="built_in">int</span> capacity;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="title">Elevator</span>(<span class="params"><span class="built_in">int</span> current=<span class="number">0</span>,<span class="built_in">int</span> target=<span class="number">0</span></span>)</span></span><br><span class="line">		&#123; </span><br><span class="line">			currentFloor = current;</span><br><span class="line">			targetFloor = target;</span><br><span class="line">			capacity = <span class="number">5</span>;</span><br><span class="line">			currentStatus = status.wait;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">getCurrentFloor</span>()</span> &#123; <span class="keyword">return</span> currentFloor; &#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">getTargetFloor</span>()</span> &#123; <span class="keyword">return</span> targetFloor;&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">getCapacity</span>()</span> &#123; <span class="keyword">return</span> capacity;&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">takePassenger</span>()</span> &#123; capacity--; &#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ariveTargetFloor</span>()</span> &#123; capacity++; &#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTargetFloor</span>(<span class="params"><span class="built_in">int</span> target</span>)</span> &#123; targetFloor = target; &#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span>(<span class="params">status sta</span>)</span> &#123;  currentStatus = sta; &#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> status <span class="title">getStatus</span>()</span> &#123; <span class="keyword">return</span> currentStatus; &#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">up</span>()</span></span><br><span class="line">		&#123; </span><br><span class="line">			currentStatus = status.up;</span><br><span class="line">			<span class="keyword">if</span> (currentFloor &lt; <span class="number">20</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				currentFloor++;</span><br><span class="line">				Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">down</span>()</span></span><br><span class="line">		&#123;</span><br><span class="line">			currentStatus = status.down;</span><br><span class="line">			<span class="keyword">if</span> (currentFloor &gt; <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				currentFloor--;</span><br><span class="line">				Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">move</span>()</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (currentFloor &lt; targetFloor)</span><br><span class="line">			&#123;</span><br><span class="line">				up();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (currentFloor &gt; targetFloor)</span><br><span class="line">			&#123;</span><br><span class="line">				down();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">check</span>()</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (capacity &lt; <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				currentStatus = status.alarm;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="Passenger类"><a href="#Passenger类" class="headerlink" title="Passenger类"></a>Passenger类</h5><ul>
<li><p>乘客的实体，记录每个乘客的ID，当前所在楼层和目标楼层，被分配到的电梯，以及请求是否已被响应：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">ElevatorSystem</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Passenger</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> currentFloor &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> targetFloor &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> assignedElevator &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">// 假设电梯分配后存储电梯的编号</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> isHandled &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="literal">false</span>; <span class="comment">// 默认为false，表示未处理</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Passenger</span>(<span class="params"><span class="built_in">int</span> ID, <span class="built_in">int</span> current, <span class="built_in">int</span> target, <span class="built_in">int</span> assigned</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            id = ID;</span><br><span class="line">            currentFloor = current;</span><br><span class="line">            targetFloor = target;</span><br><span class="line">            assignedElevator = assigned;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="类之间的联系"><a href="#类之间的联系" class="headerlink" title="类之间的联系"></a>类之间的联系</h4><ul>
<li><p>通过在<code>Form1</code>中引入<code>ElevatorController</code>的示例<code>manage</code>，实现两个类的交互，在<code>Form1</code>的初始化函数中完成对在<code>ElevatorController</code>中定义的事件的订阅：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">Form1</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    InitializeComponent();</span><br><span class="line">    InitializeElevatorUI();</span><br><span class="line">    InitialMassageBox();</span><br><span class="line">    InitializeFloorRequestButtons();</span><br><span class="line">    InitializePassengerManagementUI();</span><br><span class="line">    manage = <span class="keyword">new</span> ElevatorController();</span><br><span class="line">    manage.ElevatorMoved += Manage_ElevatorMoved;</span><br><span class="line">    manage.ElevatorRequestProcessed += Manage_ElevatorRequestProcessed;</span><br><span class="line">    manage.ElevatorExternalRequestProcessed += Manage_ExternalRequestProcessed;</span><br><span class="line">    manage.OpenDoorPressed += Manage_OpenDoorPressed;</span><br><span class="line">    manage.CloseDoorPressed += Manage_CloseDoorPressed;</span><br><span class="line">  </span><br><span class="line">    LoadImages();</span><br><span class="line">    InitializeTimer();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在<code>Form1</code>中定义<code>Passenger</code>类型的列表<code>passengers</code>，实现对乘客的管理；</p>
</li>
<li><p>在<code>ElevatorController</code>中定义<code>Elevator</code>类型的数组<code>elevators</code>，实现对五部电梯的管理；</p>
</li>
</ul>
<h4 id="调度算法"><a href="#调度算法" class="headerlink" title="调度算法"></a>调度算法</h4><ul>
<li><p>在<code>ElevatorController</code>中定义四个二维数组，记录需要处理的上行和下行请求，以及等待处理的上行和下行请求：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">int</span>[,] upRequest = <span class="keyword">new</span> <span class="built_in">int</span>[ElevatorsCount, FloorsCount];</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span>[,] downRequest = <span class="keyword">new</span> <span class="built_in">int</span>[ElevatorsCount, FloorsCount];</span><br><span class="line"><span class="comment">//wait数组里储存的是电梯需要经过状态变换才能处理的请求</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span>[,] waitUpRequest = <span class="keyword">new</span> <span class="built_in">int</span>[ElevatorsCount,FloorsCount];</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span>[,] waitDownRequest = <span class="keyword">new</span> <span class="built_in">int</span>[ElevatorsCount, FloorsCount];</span><br></pre></td></tr></table></figure>
</li>
<li><p>wait数组里储存的时电梯需要经过状态变换才能处理请求；</p>
</li>
<li><p>当上行键被按下时，调用<code>public int handleUpRequest(int floor)</code>，处理上行请求；当下行键被按下时，调用<code>public int handleDownRequest(int floor)</code> ，处理下行请求；两个函数的返回值都是被分配到的电梯编号；具体来说，调度算法如下（以处理上行请求为例）：</p>
<ul>
<li><p>根据每部电梯的状态和电梯所在楼层计算与被按下的上行键所在楼层的距离：</p>
<ul>
<li><p>如果电梯处于静止状态，这个距离等于电梯所在楼层减去上行键所在楼层的绝对值；</p>
</li>
<li><p>如果电梯处于上行状态，那么分为两种情况：</p>
<ul>
<li><p>电梯当前所在楼层大于上行键所在楼层，这个距离等于该电梯目前向上请求中最高的层减去电梯所在楼层的绝对值，加上电梯目前向上请求中最高的层减去上行键所在楼层的绝对值；</p>
<p><img src="/../img/elevator-images/dist%E8%AE%A1%E7%AE%97%E5%9B%BE.jpg" alt="dist计算图"></p>
</li>
<li><p>电梯当前所在楼层小于上行键所在楼层，这个距离等于电梯当前所在楼层减去上行键所在楼层的绝对值；</p>
</li>
</ul>
</li>
<li><p>如果电梯处于下行状态，那么这个距离等于该电梯目前向下请求中的最低的层减去电梯所在楼层的绝对值，加上电梯目前向下请求中最低的层减去上行键所在楼层的绝对值；</p>
</li>
</ul>
</li>
<li><p>选出与上行键所在楼层距离最近的电梯，并在其上行请求列表中添加上行键所在的楼层：</p>
<ul>
<li>如果该电梯目前处于静止状态，那么有两种情况：<ul>
<li>上行键所在楼层大于电梯所在楼层，把该请求添加进<code>upRequest[elevatorIndex,floor]</code>中，因为电梯即将改变成上行状态，该请求能立即得到处理；</li>
<li>上行键所在楼层小于电梯所在楼层，把该请求添加进<code>waitUpRequest[elevatorIndex,floor]</code>中，因为电梯需要先改变成下行状态，再改变成上行状态，才能处理该请求；</li>
</ul>
</li>
<li>如果电梯目前处于上行状态，那么有两种情况：<ul>
<li>上行键所在楼层大于电梯所在楼层，把该请求添加进<code>upRequest[elevatorIndex,floor]</code>中，因为电梯不需要改变状态就可以响应该请求；</li>
<li>上行键所在楼层小于电梯所在楼层，把该请求添加进<code>waitUpRequest[elevatorIndex,floor]</code>中，因为该电梯需要改变状态才能响应该请求；</li>
</ul>
</li>
<li>如果电梯处于下行状态，那么直接把请求添加进<code>waitUpRequest[elevator,Index]</code>中，因为该电梯需要改变状态才能响应该请求。</li>
</ul>
</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">handleUpRequest</span>(<span class="params"><span class="built_in">int</span> floor</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="built_in">int</span> minDist = FloorsCount + <span class="number">1</span>;</span><br><span class="line">      <span class="built_in">int</span> elevatorIndex = ElevatorsCount;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;ElevatorsCount;i++)</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="built_in">int</span> currentFloor = elevators[i].getCurrentFloor();</span><br><span class="line">          <span class="keyword">if</span> (elevators[i].getStatus()==status.alarm)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">continue</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (elevators[i].getStatus()==status.wait)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">if</span>(Math.Abs(currentFloor-floor) &lt; minDist)</span><br><span class="line">              &#123;</span><br><span class="line">                  minDist=Math.Abs(currentFloor-floor);</span><br><span class="line">                  elevatorIndex=i;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (elevators[i].getStatus()==status.up)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">if</span>(currentFloor &lt;= floor)</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="keyword">if</span>(Math.Abs(currentFloor-floor)&lt;minDist)</span><br><span class="line">                  &#123; </span><br><span class="line">                      minDist = Math.Abs(currentFloor-floor);</span><br><span class="line">                      elevatorIndex = i; </span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span> <span class="keyword">if</span>(currentFloor &gt; floor)</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="built_in">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">                  <span class="comment">//找到目前向上请求中最高的楼层</span></span><br><span class="line">                  <span class="keyword">for</span>(<span class="built_in">int</span> j=FloorsCount<span class="number">-1</span>;j&gt;=<span class="number">0</span>;j--)</span><br><span class="line">                  &#123;</span><br><span class="line">                      <span class="keyword">if</span> (upRequest[i, j] == <span class="number">1</span>)</span><br><span class="line">                      &#123;</span><br><span class="line">                          tmp = j;</span><br><span class="line">                          <span class="keyword">break</span>;</span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="comment">//计算距离</span></span><br><span class="line">                  <span class="built_in">int</span> dist = Math.Abs(tmp - currentFloor) + Math.Abs(tmp - floor);</span><br><span class="line">                  <span class="keyword">if</span>(dist&lt;minDist)</span><br><span class="line">                  &#123;</span><br><span class="line">                      minDist=dist;</span><br><span class="line">                      elevatorIndex = i;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">  </span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (elevators[i].getStatus()==status.down)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="built_in">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">              <span class="comment">//找到目前向下请求中最小的层</span></span><br><span class="line">              <span class="keyword">for</span>(<span class="built_in">int</span> j=<span class="number">0</span>;j&lt;FloorsCount;j++)</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="keyword">if</span> (downRequest[i, j] == <span class="number">1</span>)</span><br><span class="line">                  &#123;</span><br><span class="line">                      tmp = j;</span><br><span class="line">                      <span class="keyword">break</span>;</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="built_in">int</span> dist=Math.Abs(tmp - currentFloor) + Math.Abs(tmp - floor);</span><br><span class="line">              <span class="keyword">if</span>(dist&lt;minDist) </span><br><span class="line">              &#123;</span><br><span class="line">                  minDist=dist;</span><br><span class="line">                  elevatorIndex = i;</span><br><span class="line">              &#125;</span><br><span class="line">  </span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">int</span> currenFloor = elevators[elevatorIndex].getCurrentFloor();</span><br><span class="line">      <span class="keyword">if</span> (elevators[elevatorIndex].getStatus()==status.wait) </span><br><span class="line">      &#123;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span>(floor &gt;= currenFloor)</span><br><span class="line">              upRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">              waitUpRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">          </span><br><span class="line">          <span class="comment">//upRequest[elevatorIndex, floor] = 1;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (elevators[elevatorIndex].getStatus()==status.up)</span><br><span class="line">          </span><br><span class="line">      &#123;</span><br><span class="line">          <span class="keyword">if</span> (floor &gt;= currenFloor)</span><br><span class="line">              upRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">              waitUpRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">          waitUpRequest[elevatorIndex,floor] = <span class="number">1</span>;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">return</span> elevatorIndex;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">* 当楼层按钮被按下时，直接对`upRequest`和`downRequest`进行修改，当在上行电梯中按下比电梯当前所在楼层小的楼层，将不会被响应，当在下行电梯中按下比电梯当前所在楼层小的楼层，将不会被响应：</span><br><span class="line"></span><br><span class="line">  ```c<span class="meta">#</span></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FloorButton_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e, <span class="built_in">int</span> elevatorIndex, <span class="built_in">int</span> floor</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">  </span><br><span class="line">       Button clickButton = sender <span class="keyword">as</span> Button;</span><br><span class="line">      </span><br><span class="line">       <span class="comment">// 处理楼层按钮点击事件</span></span><br><span class="line">       <span class="comment">//MessageBox.Show($&quot;电梯 &#123;elevatorIndex + 1&#125; 的第 &#123;floor + 1&#125; 层按钮被点击&quot;);</span></span><br><span class="line">       <span class="keyword">if</span> (manage.elevators[elevatorIndex].getStatus()==status.up)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">if</span> (floor &gt;= manage.elevators[elevatorIndex].getCurrentFloor()) </span><br><span class="line">           &#123;</span><br><span class="line">               manage.upRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">               <span class="keyword">if</span> (clickButton != <span class="literal">null</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   clickButton.BackColor = Color.Green;</span><br><span class="line">               &#125;</span><br><span class="line">  </span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (manage.elevators[elevatorIndex].getStatus()==status.down) </span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">if</span> (floor &lt;= manage.elevators[elevatorIndex].getCurrentFloor())</span><br><span class="line">           &#123;</span><br><span class="line">               manage.downRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">               <span class="keyword">if</span> (clickButton != <span class="literal">null</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   clickButton.BackColor = Color.Green;</span><br><span class="line">               &#125;</span><br><span class="line">  </span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">if</span> (floor &gt;= manage.elevators[elevatorIndex].getCurrentFloor())</span><br><span class="line">           &#123;</span><br><span class="line">               manage.upRequest[elevatorIndex, floor] = <span class="number">1</span>;</span><br><span class="line">               <span class="keyword">if</span> (clickButton != <span class="literal">null</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   clickButton.BackColor = Color.Green;</span><br><span class="line">               &#125;</span><br><span class="line">  </span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span> </span><br><span class="line">           &#123;</span><br><span class="line">               manage.downRequest[elevatorIndex,floor] = <span class="number">1</span>;</span><br><span class="line">               <span class="keyword">if</span> (clickButton != <span class="literal">null</span>)</span><br><span class="line">               &#123;</span><br><span class="line">                   clickButton.BackColor = Color.Green;</span><br><span class="line">               &#125;</span><br><span class="line">  </span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="电梯运行逻辑"><a href="#电梯运行逻辑" class="headerlink" title="电梯运行逻辑"></a>电梯运行逻辑</h4><ul>
<li><p>为每部电梯启动一个独立的线程，并设置线程为后台线程，线程执行<code>private void ElevatorRoutine(int elevatorIndex) </code>方法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">StartElevatorThreads</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;ElevatorsCount;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> index = i;</span><br><span class="line">        Thread elevatorThread = <span class="keyword">new</span> Thread(() =&gt; ElevatorRoutine(index))</span><br><span class="line">        &#123;</span><br><span class="line">            IsBackground = <span class="literal">true</span></span><br><span class="line">        &#125;;</span><br><span class="line">        elevatorThread.Start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ElevatorRoutine</span>(<span class="params"><span class="built_in">int</span> elevatorIndex</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">  </span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        pullUpward(elevatorIndex);</span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        prepareForDown(elevatorIndex);</span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        pushDownward(elevatorIndex);</span><br><span class="line">        Thread.Sleep(<span class="number">500</span>);</span><br><span class="line">        prepareForUp(elevatorIndex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在<code>void pullUpward(int elevatorIndex)</code>里处理电梯的上行请求，在<code>void pushDownward(int elevatorIndex)</code>里处理电梯的下行请求；</p>
</li>
<li><p>对<code>waitUpRequest</code>和<code>waitDownRequest</code>的处理分别在<code>prepareForUp</code>和<code>prepareForDown</code>中进行；</p>
</li>
<li><p>在<code>ElevatorController</code>的初始化函数中启动线程：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ElevatorController</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;elevators.Length; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        elevators[i] = <span class="keyword">new</span> Elevator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i &lt; ElevatorsCount;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> j=<span class="number">0</span>;j &lt; FloorsCount;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            upRequest[i, j] = <span class="number">0</span>;</span><br><span class="line">            downRequest[i, j] = <span class="number">0</span>;</span><br><span class="line">            waitUpRequest[i, j] = <span class="number">0</span>;</span><br><span class="line">            waitDownRequest[i, j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    StartElevatorThreads();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="事件定义"><a href="#事件定义" class="headerlink" title="事件定义"></a>事件定义</h4><ul>
<li><p>在ElevatorController中定义了五个事件：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">int</span>, <span class="built_in">int</span>&gt; ElevatorMoved;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">int</span>, <span class="built_in">int</span>&gt; ElevatorRequestProcessed;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">int</span>, <span class="built_in">int</span>&gt; ElevatorExternalRequestProcessed;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">int</span>&gt; OpenDoorPressed;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> Action&lt;<span class="built_in">int</span>&gt; CloseDoorPressed;</span><br></pre></td></tr></table></figure>

<p>分别用于处理电梯移动，电梯楼层请求被处理和电梯外部请求被处理，开门按钮被按下和关门按钮被按下；</p>
</li>
<li><p>在Form1中订阅这些事件：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">manage.ElevatorMoved += Manage_ElevatorMoved;</span><br><span class="line">manage.ElevatorRequestProcessed += Manage_ElevatorRequestProcessed;</span><br><span class="line">manage.ElevatorExternalRequestProcessed += Manage_ExternalRequestProcessed;</span><br><span class="line">manage.OpenDoorPressed += Manage_OpenDoorPressed;</span><br><span class="line">manage.CloseDoorPressed += Manage_CloseDoorPressed;</span><br></pre></td></tr></table></figure>
</li>
<li><p>事件订阅是一个在软件设计中常见的模式，它属于更广泛的发布-订阅（pub-sub）模式。在这种模式中，组件可以宣布（发布）某些事件的发生，而其他组件可以表达对这些事件的兴趣（订阅），当事件发生时，这些订阅了事件的组件会自动接收通知并作出相应的响应。</p>
</li>
<li><p>例如，在<code>ElevatorController</code>的<code>pullUpward</code>方法中，执行下面这个片段，程序会检验电梯当前所在楼层是否存在请求，如果有，则请求被响应，事件被触发，接着订阅了事件的方法将会被调用，楼层按钮和上行按钮的高亮会消失，电梯也能得到位置的更新：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (elevators[elevatorIndex].getCurrentFloor() != elevators[elevatorIndex].getTargetFloor())</span><br><span class="line">&#123;</span><br><span class="line">    elevators[elevatorIndex].move();</span><br><span class="line">    <span class="keyword">if</span> (upRequest[elevatorIndex, elevators[elevatorIndex].getCurrentFloor()] == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        upRequest[elevatorIndex, elevators[elevatorIndex].getCurrentFloor()] = <span class="number">0</span>;</span><br><span class="line">        ElevatorRequestProcessed.Invoke(elevatorIndex, elevators[elevatorIndex].getCurrentFloor());</span><br><span class="line">        ElevatorExternalRequestProcessed.Invoke(elevators[elevatorIndex].getCurrentFloor(), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ElevatorMoved.Invoke(elevatorIndex, elevators[elevatorIndex].getCurrentFloor());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (elevators[elevatorIndex].getCurrentFloor() == i)</span><br><span class="line">&#123;</span><br><span class="line">    upRequest[elevatorIndex, i] = <span class="number">0</span>;</span><br><span class="line">    ElevatorRequestProcessed.Invoke(elevatorIndex, i);</span><br><span class="line">    ElevatorExternalRequestProcessed.Invoke(i, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="定义定时器"><a href="#定义定时器" class="headerlink" title="定义定时器"></a>定义定时器</h4><ul>
<li><p>定时器（Timer）在编程中用于在设定的时间间隔内重复执行某些任务，或者在一定的延迟之后执行任务。<code>checkElevatorTimer.Elapsed += CheckElevatorStatus;</code> 这行代码表示将 <code>CheckElevatorStatus</code> 方法绑定到定时器的 <code>Elapsed</code> 事件。这意味着每当定时器的计时周期结束时，<code>CheckElevatorStatus</code> 方法将被自动调用。<code>AutoReset = true</code> 设置定时器在触发 <code>Elapsed</code> 事件后自动重新开始计时。这使得定时器成为一个重复触发的周期性定时器。</p>
</li>
<li><p>项目中一共使用了三个定时器，分别用于播放动画，检查电梯状态，以及更新乘客列表：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">InitializeTimer</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    animationTimer.Interval = <span class="number">200</span>; <span class="comment">// 设置动画帧切换的时间间隔为200毫秒</span></span><br><span class="line">    animationTimer.Tick += <span class="keyword">new</span> EventHandler(AnimationTimer_Tick);</span><br><span class="line">    updateTimer = <span class="keyword">new</span> System.Windows.Forms.Timer();</span><br><span class="line">    updateTimer.Interval = <span class="number">1000</span>;  <span class="comment">// 更新间隔设置为1000毫秒（1秒）</span></span><br><span class="line">    updateTimer.Tick += <span class="keyword">new</span> EventHandler(UpdateTimer_Tick);</span><br><span class="line">    updateTimer.Start();</span><br><span class="line">    <span class="comment">// 初始化定时器</span></span><br><span class="line">    checkElevatorTimer = <span class="keyword">new</span> System.Timers.Timer(<span class="number">1000</span>); <span class="comment">// 设置时间间隔为1秒</span></span><br><span class="line">    checkElevatorTimer.Elapsed += CheckElevatorStatus;</span><br><span class="line">    checkElevatorTimer.AutoReset = <span class="literal">true</span>;</span><br><span class="line">    checkElevatorTimer.Enabled = <span class="literal">true</span>; <span class="comment">// 初始状态为禁用</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>CheckElevatorStatus</code>定时检查是否有电梯到达了乘客的目标楼层，并更新电梯的状态标签：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">CheckElevatorStatus</span>(<span class="params">Object source, System.Timers.ElapsedEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 在Task.Run内执行需要在UI线程上完成的操作</span></span><br><span class="line">    <span class="keyword">await</span> Task.Run(() =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        Invoke((MethodInvoker)<span class="built_in">delegate</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> passenger <span class="keyword">in</span> passengers)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!passenger.isHandled &amp;&amp; manage.elevators[passenger.assignedElevator].getCurrentFloor() == passenger.currentFloor)</span><br><span class="line">                &#123;</span><br><span class="line">                    passenger.isHandled = <span class="literal">true</span>;</span><br><span class="line">                    messageBox.AppendText(<span class="string">$&quot;Please press the open door button for Elevator <span class="subst">&#123;passenger.assignedElevator + <span class="number">1</span>&#125;</span> to let the passenger in.<span class="subst">&#123;Environment.NewLine&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">var</span> openTcs = <span class="keyword">new</span> TaskCompletionSource&lt;<span class="built_in">bool</span>&gt;();</span><br><span class="line">                    openDoorTcs[passenger.assignedElevator] = openTcs;</span><br><span class="line">                    openTcs.Task.ContinueWith(<span class="keyword">async</span> t =&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// 等待两秒后，执行后续逻辑</span></span><br><span class="line">                        <span class="keyword">await</span> Task.Delay(<span class="number">2000</span>);</span><br><span class="line">                        openDoorButtons[passenger.assignedElevator].BackColor = Color.White;</span><br><span class="line">                        <span class="keyword">var</span> closeTcs = <span class="keyword">new</span> TaskCompletionSource&lt;<span class="built_in">bool</span>&gt;();</span><br><span class="line">                        closeDoorTcs[passenger.assignedElevator] = closeTcs;</span><br><span class="line">                        <span class="keyword">await</span> closeTcs.Task;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 关门后延迟两秒</span></span><br><span class="line">                        <span class="keyword">await</span> Task.Delay(<span class="number">2000</span>);</span><br><span class="line">                        closeDoorButtons[passenger.assignedElevator].BackColor = Color.White;</span><br><span class="line">                        Invoke((MethodInvoker)(() =&gt; toTargetFloorOfPassenger(passenger.id, passenger.assignedElevator, passenger.targetFloor)));</span><br><span class="line">                    &#125;, TaskScheduler.FromCurrentSynchronizationContext());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 其他状态更新也必须在UI线程上执行</span></span><br><span class="line">    Invoke((MethodInvoker)<span class="built_in">delegate</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ElevatorsCount; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            Elevator elevator = manage.elevators[i];</span><br><span class="line">            status currentStatus = elevator.getStatus();</span><br><span class="line">            <span class="built_in">int</span> capacity = elevator.getCapacity();</span><br><span class="line">            elevatorCapacityLabels[i].Text = <span class="string">$&quot;Capacity: <span class="subst">&#123;capacity&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 更新状态标签颜色及文字</span></span><br><span class="line">            UpdateElevatorStatusLabels(currentStatus, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">kiy-00</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/">http://example.com/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">kiy-00的生活学习碎片</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9D%A2%E5%90%91%E4%BD%9C%E8%80%85/">面向作者</a><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></div><div class="post-share"><div class="social-share" data-image="/img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/02/14/%E4%BA%94%E5%AD%90%E6%A3%8B%E5%AF%B9%E6%88%98%E7%A8%8B%E5%BA%8F/" title="五子棋对战程序 Gomoku"><img class="cover" src="/img/projects/gomoku.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">五子棋对战程序 Gomoku</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2025/02/19/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%A8%A1%E6%8B%9F%E7%B3%BB%E7%BB%9F%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="文件管理模拟系统 设计方案报告"><img class="cover" src="/img/filemanagement-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">文件管理模拟系统 设计方案报告</div></div><div class="info-2"><div class="info-item-1">文件管理模拟系统 设计方案报告目录 开发环境 项目结构 界面 操作说明 实现的功能 系统分析 实现的类 FCB类 Node类 Category类     系统实现 为文件内容分配磁盘空间 获取文件内容 删除文件内容 更新文件内容 检查同目录下是否有同名文件 保存文件内容 创建目录树 磁盘文件的写入和读取 目录文件的写入和读取    开发环境 开发环境：Windows 11 开发软件：Pycharm 开发语言：Python 3.11 主要引用模块： PyQt5 sys os    项目结构1234567891011121314151617FileManageSystem/    BitMapInfo.txt    Category.py    CategoryInfo.txt    FCB.py    main.py    MyDiskInfo.txt    project_structure.txt    VirtualDisk.py    运行时截图.png    docs/        文件管理模拟系统 设计方案报告.md    res/        cat.jpg  ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/02/19/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%A8%A1%E6%8B%9F%E7%B3%BB%E7%BB%9F%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="文件管理模拟系统 设计方案报告"><img class="cover" src="/img/filemanagement-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-19</div><div class="info-item-2">文件管理模拟系统 设计方案报告</div></div><div class="info-2"><div class="info-item-1">文件管理模拟系统 设计方案报告目录 开发环境 项目结构 界面 操作说明 实现的功能 系统分析 实现的类 FCB类 Node类 Category类     系统实现 为文件内容分配磁盘空间 获取文件内容 删除文件内容 更新文件内容 检查同目录下是否有同名文件 保存文件内容 创建目录树 磁盘文件的写入和读取 目录文件的写入和读取    开发环境 开发环境：Windows 11 开发软件：Pycharm 开发语言：Python 3.11 主要引用模块： PyQt5 sys os    项目结构1234567891011121314151617FileManageSystem/    BitMapInfo.txt    Category.py    CategoryInfo.txt    FCB.py    main.py    MyDiskInfo.txt    project_structure.txt    VirtualDisk.py    运行时截图.png    docs/        文件管理模拟系统 设计方案报告.md    res/        cat.jpg  ...</div></div></div></a><a class="pagination-related" href="/2025/02/03/mdhelp/" title="发文教学"><img class="cover" src="/img/blog-init/sakura.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-03</div><div class="info-item-2">发文教学</div></div><div class="info-2"><div class="info-item-1">一级标题二级标题三级标题四级标题 无序列表   有序列表正文高亮文本  1代码框  123456#include &lt;bits/stdc++.h&gt;using namespace std;int main()&#123;    return 0;    //代码高亮的代码框&#125;  链接名字百度 hexo cl 删除缓存（public文件夹）hexo g 生成html文件（public文件夹）hexo d 上传githubhexo s 预览界面 一键三连1hexo cl &amp;&amp; hexo g &amp;&amp; hexo d  1hexo cl;hexo g;hexo d 不想上传d换成s预览即可 </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">kiy-00</div><div class="author-info-description">在云南长大，去上海学习的大学生的个人博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kiy-00"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/kiy-00" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:kikikiki43299@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到kiy-00的博客，这里是我的学习记录和生活碎片，希望你能在这里找到你想要的。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6-%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A"><span class="toc-number">1.</span> <span class="toc-text">处理机管理-电梯调度 设计方案报告</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.</span> <span class="toc-text">开发环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">1.3.</span> <span class="toc-text">实现的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%95%8C%E9%9D%A2"><span class="toc-number">1.4.</span> <span class="toc-text">界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97"><span class="toc-number">1.5.</span> <span class="toc-text">操作指南</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">1.6.</span> <span class="toc-text">主要设计思路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E7%9A%84%E7%B1%BB"><span class="toc-number">1.6.1.</span> <span class="toc-text">实现的类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Elevator%E7%B1%BB"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">Elevator类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Passenger%E7%B1%BB"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">Passenger类</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB"><span class="toc-number">1.6.2.</span> <span class="toc-text">类之间的联系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95"><span class="toc-number">1.6.3.</span> <span class="toc-text">调度算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E6%A2%AF%E8%BF%90%E8%A1%8C%E9%80%BB%E8%BE%91"><span class="toc-number">1.6.4.</span> <span class="toc-text">电梯运行逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%AE%9A%E4%B9%89"><span class="toc-number">1.6.5.</span> <span class="toc-text">事件定义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-number">1.6.6.</span> <span class="toc-text">定义定时器</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="处理机管理-电梯调度 设计方案报告"><img src="/img/elevator-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="处理机管理-电梯调度 设计方案报告"/></a><div class="content"><a class="title" href="/2025/02/19/%E5%A4%84%E7%90%86%E6%9C%BA%E7%AE%A1%E7%90%86-%E7%94%B5%E6%A2%AF%E8%B0%83%E5%BA%A6%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="处理机管理-电梯调度 设计方案报告">处理机管理-电梯调度 设计方案报告</a><time datetime="2025-02-19T08:00:00.000Z" title="发表于 2025-02-19 16:00:00">2025-02-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/19/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%A8%A1%E6%8B%9F%E7%B3%BB%E7%BB%9F%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="文件管理模拟系统 设计方案报告"><img src="/img/filemanagement-images/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%88%AA%E5%9B%BE.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="文件管理模拟系统 设计方案报告"/></a><div class="content"><a class="title" href="/2025/02/19/%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E6%A8%A1%E6%8B%9F%E7%B3%BB%E7%BB%9F%20%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88%E6%8A%A5%E5%91%8A/" title="文件管理模拟系统 设计方案报告">文件管理模拟系统 设计方案报告</a><time datetime="2025-02-19T08:00:00.000Z" title="发表于 2025-02-19 16:00:00">2025-02-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/14/%E4%BA%94%E5%AD%90%E6%A3%8B%E5%AF%B9%E6%88%98%E7%A8%8B%E5%BA%8F/" title="五子棋对战程序 Gomoku"><img src="/img/projects/gomoku.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="五子棋对战程序 Gomoku"/></a><div class="content"><a class="title" href="/2025/02/14/%E4%BA%94%E5%AD%90%E6%A3%8B%E5%AF%B9%E6%88%98%E7%A8%8B%E5%BA%8F/" title="五子棋对战程序 Gomoku">五子棋对战程序 Gomoku</a><time datetime="2025-02-14T01:00:17.000Z" title="发表于 2025-02-14 09:00:17">2025-02-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/03/mdhelp/" title="发文教学"><img src="/img/blog-init/sakura.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="发文教学"/></a><div class="content"><a class="title" href="/2025/02/03/mdhelp/" title="发文教学">发文教学</a><time datetime="2025-02-03T03:33:17.000Z" title="发表于 2025-02-03 11:33:17">2025-02-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By kiy-00</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>